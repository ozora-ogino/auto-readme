```markdown
# ozora-ogino/auto-readme

## Description
This project uses an OpenAI-powered tool to automatically generate and update README files based on changes in pull requests. The tool focuses on analyzing critical changes such as workflows, package.json, and application endpoints. The tool now has an enhanced mechanism for dealing with large diffs, breaking them into manageable chunks and processing each separately to efficiently generate the updated README content.

## Dependencies
- Python packages: PyGithub, openai

## Features
- Automatic README generation and updates based on incoming pull requests.
- Identify changes focusing primarily on workflows, package.json, application endpoints, and other critical code alterations.
- The new update exposes several functions for getting the PR diff, reading the current and template README, as well as determining critical changes based on file name and patches.
- Time delay feature for API calls to avoid rate limiting.
- Includes logging system to report issues during content generation.
- Flexible and customizable based on user requirements.
- The latest updates define better management for larger diffs by breaking them into manageable chunks, thus improving the performance of content generation.
- The tool prevents unnecessary updates when no critical changes are detected or if the generated content for a chunk doesn't trigger significant changes.
- Ability to change the OpenAI model version.

## Installation
Initially, copy the entire `.github/workflows/auto-readme.yml` file to `.github/workflows/` directory in your repository. Then, establish a `.github/README_TEMPLATE.md` file in the same repository using the provided structured template. Setup the required secrets and variables in your repository by visiting `Settings > Secrets` in your directory and add a new repository secret named `OPENAI_API_KEY` with your OpenAI API key and `GH_TOKEN` with your GitHub Personal Access Token.

## Usage
After proper setup, the tool automatically updates the README whenever a pull request is made, excluding changes directed at the README itself.

## Recent Updates
- The repository now includes functionality to automatically update the README file based on critical changes in pull requests. Functionality includes identifying critical file changes and generating new README content accordingly.
- Added support for getting a PR's diff, reading the template and current README, and determining critical changes based on file name and patches to `update_readme.py`.
- A time delay has been added between API calls in the update process to avoid hitting rate limits.
- Additional logging has been added to assist with troubleshooting and improve clarity of the update process.
- The latest updates have introduced a new mechanism to handle large diffs by breaking them into manageable chunks for effective processing.
- Skips to the next chunk when content generation fails or if no significant changes are needed.
- Updates only proceed when critical changes are detected or when generated content for a chunk entails significant changes.
- The default OpenAI model version used has been set to "gpt-3.5-turbo".
- README files can now be updated directly with new content generated by the application.

## Contributing
Community contributions to improve this action are always welcome! Please submit a pull request or open an issue on the repository.

## License
This project is licensed under the terms of the MIT license.

## Contact
For detailed information or to report issues, please visit: https://github.com/ozora-ogino/auto-readme/issues

## Troubleshooting
If you encounter any issues, please ensure:

1. The `OPENAI_API_KEY` and `GH_TOKEN` secrets are correctly set in your repository.
2. The `GH_TOKEN` has the necessary permissions - `repo` scope for private repositories, `public_repo` for public repositories.
3. The repository settings for Actions are correctly configured as mentioned in the setup instructions.
4. Check the Action logs for any error messages or unexpected behavior. 
5. `OPENAI_MODEL` variable is set to a valid OpenAI model (gpt-4).

## Customization
You can adjust this action by altering the Python script in the "Update README" step. For example, adjusting the prompt, modifying how critical changes are detected, or changing the OpenAI model version is completely manageable.
```